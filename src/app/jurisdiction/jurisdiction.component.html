<div class="container">

    <!-- Olda Card -->
    <div class="card">

        <!-- Card content -->
        <div class="card-body">
            <div class="row">
                <div class="col-12 pt-3">
                    <h3>Jurisdição</h3>
                </div>
            </div>
            <hr>
            <div class="row">
                <!-- dynamic tree-->
                <div class="col-12">
                    <button class="p-2" type="button" mdbBtn color="success" mdbWavesEffect (click)="frame.show()">Criar
                        Juridição</button>
                    <button class="p-2" type="button" mdbBtn color="danger" mdbWavesEffect
                        (click)="frame2.show()">Excluir Juridição</button>
                </div>
                <div class="col-12">
                    <div *ngIf="!isLoaded" id="spinner-loading" class="justify-content-center">Carregando...
                        <div class="spinner-border" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
                        <!-- This is the tree node template for leaf nodes -->
                        <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
                            <li class="mat-tree-node">
                                <!-- use a disabled button to provide padding for tree leaf -->
                                <button mat-icon-button disabled></button>
                                <img src="../../assets/image/{{node.jurisdictionId}}.png" width="20px" height="20px"
                                    style="margin-right: 3px">{{node.name}}
                            </li>
                        </mat-tree-node>
                        <!-- This is the tree node template for expandable nodes -->
                        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                            <li style="list-style: none">
                                <div class="mat-tree-node">
                                    <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
                                        <mat-icon class="mat-icon-rtl-mirror">
                                            {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                                        </mat-icon>
                                    </button>
                                    <img src="../../assets/image/{{node.jurisdictionId}}.png" width="20px" height="20px"
                                        style="margin-right: 3px">{{node.name}}
                                </div>
                                <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)"
                                    style="list-style: none">
                                    <ng-container matTreeNodeOutlet></ng-container>
                                </ul>
                            </li>
                        </mat-nested-tree-node>
                    </mat-tree>
                </div>
            </div>
        </div>

    </div>
    <!-- Card -->

</div>

<!--Modal create jurisdiction-->
<div mdbModal #frame="mdbModal" class="modal fade" scrollY="true" maxHeight="200" id="frameModalTop" tabindex="-1"
    role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
    [config]="{backdrop: false, ignoreBackdropClick: true}">
    <div class="modal-dialog modal-notify modal-success" role="document">
        <!--Content-->
        <div class="modal-content">
            <!--Header-->
            <div class="modal-header">
                <p class="heading lead">Criar Jurisdição</p>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="frame.hide()">
                    <span aria-hidden="true" class="white-text">&times;</span>
                </button>
            </div>

            <!--Body-->
            <div class="modal-body">
                <div class="col-12">
                    <!-- Form -->
                    <form style="color: #757575;" [formGroup]="jurisdictionForm">

                        <label>Tipo *</label>
                        <div *ngFor="let jurisdiction of jurisdictions" style="margin-left: 15px">
                            <input type="radio" [value]="jurisdiction.id" formControlName="jurisdictionId" required>
                            <label for="jurType">{{jurisdiction.name}}</label>
                        </div>

                        <mat-form-field class="w-100">
                            <mat-label>Nome</mat-label>
                            <input matInput formControlName="name" required>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>Login</mat-label>
                            <input matInput formControlName="login" required>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>Senha</mat-label>
                            <input matInput type="password" formControlName="password" required>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>Confirmar senha</mat-label>
                            <input matInput type="password" formControlName="confirmPassword" (keyup)="compararSenha()" required> 
                            <mat-error *ngIf="!senhaOk">As senhas não conferem</mat-error>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>E-mail</mat-label>
                            <input matInput type="email" formControlName="email" (keyup)="emailErrado()" required>
                            <mat-error *ngIf="!emailOk">E-mail inválido</mat-error>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>Jurisdição Pai</mat-label>
                            <mat-select formControlName="parentId" required>
                                <mat-option *ngFor="let user of treeList" [value]="user.id">
                                    {{user.jurisdictionId}}-{{user.name}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="w-100">
                            <mat-label>Observação</mat-label>
                            <textarea matInput rows="3" formControlName="obs"></textarea>
                        </mat-form-field>

                    </form>
                    <!-- Form -->
                </div>
            </div>
            <!--Body-->

            <!--Footer-->
            <div class="modal-footer justify-content-center">
                <button type="submit" mdbBtn color="success" class="waves-light" mdbWavesEffect (click)="addNewUserAdmin(frame)"
                    [disabled]="!jurisdictionForm.valid && !senhaOk">Confirmar</button>
                <button type="submit" mdbBtn color="primary" outline="true" class="waves-effect" mdbWavesEffect
                    (click)="frame.hide()" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
        <!--/.Content-->
    </div>
</div>
<!--Modal create jurisdiction-->

<!--Modal delete jurisdiction-->
<div mdbModal #frame2="mdbModal" class="modal fade" scrollY="true" maxHeight="200" id="frameModalTop" tabindex="-1"
    role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
    [config]="{backdrop: false, ignoreBackdropClick: true}">
    <div class="modal-dialog modal-notify modal-danger" role="document">
        <!--Content-->
        <div class="modal-content">
            <!--Header-->
            <div class="modal-header">
                <p class="heading lead">Criar Jurisdição</p>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="frame2.hide()">
                    <span aria-hidden="true" class="white-text">&times;</span>
                </button>
            </div>

            <!--Body-->
            <div class="modal-body">
                <div class="col-12">
                    <!-- Form -->
                    <form style="color: #757575;">

                        <!-- Jurisdiction -->
                        <mat-form-field class="w-100">
                            <mat-label>Jurisdição a excluir</mat-label>
                            <mat-select required [(ngModel)]="jurisdictionToDelete" name="parent">
                                <mat-option [value]="0">Escolha...</mat-option>
                                <mat-option *ngFor="let user of treeListRemove" [value]="user.id">
                                    {{user.jurisdictionId}}-{{user.name}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                    </form>
                    <!-- Form -->
                </div>
            </div>
            <!--Body-->

            <!--Footer-->
            <div class="modal-footer justify-content-center">
                <button type="submit" mdbBtn color="danger" class="waves-light" [disabled]="!jurisdictionToDelete" 
                        mdbWavesEffect (click)="removeUserAdmin(frame2)" >Excluir</button>
                <button mdbBtn color="primary" outline="true" class="waves-effect" mdbWavesEffect 
                (click)="frame2.hide()" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
        <!--/.Content-->
    </div>
</div>
<!--Modal delete jurisdiction-->